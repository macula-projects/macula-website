<!doctype html><html lang=zh-cn class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.111.3"><link rel=canonical type=text/html href=/docs/v3.1/chapter1/><link rel=alternate type=application/rss+xml href=/docs/v3.1/chapter1/index.xml><meta name=robots content="noindex, nofollow"><link rel=icon href=/favicons/favicon.ico><title>第一章 | Macula</title><meta name=description content="Macula介绍"><meta property="og:title" content="第一章"><meta property="og:description" content="Macula介绍"><meta property="og:type" content="website"><meta property="og:url" content="/docs/v3.1/chapter1/"><meta property="og:site_name" content="Macula"><meta itemprop=name content="第一章"><meta itemprop=description content="Macula介绍"><meta name=twitter:card content="summary"><meta name=twitter:title content="第一章"><meta name=twitter:description content="Macula介绍"><link rel=preload href=/scss/main.min.56f91794193debaacc9fed9f3ea1305973c18c460520344068f08ae5f95e5027.css as=style><link href=/scss/main.min.56f91794193debaacc9fed9f3ea1305973c18c460520344068f08ae5f95e5027.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-00000000-0")}</script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><img src=/img/logo.png></span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/><span>首页</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/project><span>项目</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs><span>文档</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog><span>博客</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=http://14.22.2.220:80/#/login target=_blank><span>体验版</span></a></li></ul></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>这是本节的多页打印视图。
<a href=# onclick="return print(),!1">点击此处打印</a>.</p><p><a href=/docs/v3.1/chapter1/>返回本页常规视图</a>.</p></div><h1 class=title>第一章</h1><div class=lead>Macula介绍</div><ul><li>1: <a href=#pg-66d4dda8c7daa9c25e5f1ad8af7bb3a1>概述</a></li><li>2: <a href=#pg-856bcd50b5341f8eb81a62e8fcb7a65e>快速开始</a></li><li>3: <a href=#pg-68884f4139f98cc70f503022886b0dc0>项目构建</a></li><li>4: <a href=#pg-fee5264e2587493d9d70bfda97be4f07>版本发布</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-66d4dda8c7daa9c25e5f1ad8af7bb3a1>1 - 概述</h1><div class=lead>Macula概述</div><h2 id=技术架构>技术架构</h2><p>Macula开发平台是选用一些广泛使用的、优秀的开源框架作为底层实现，并在这些开源框架上整合调整，以最佳实践的方式构建而来的开发平台。所以熟悉和了解所使用的开源框架，是了解和深入Macula开发平台的前提。</p><p>Macula开发平台使用的开源技术有：</p><ul><li><strong>Spring Framework</strong>：Spring作为优秀的开源框架，也是Macula平台的主线框架,Macula平台的开发均围绕SpringFramework，并在此基础上引入相应的扩展。</li><li><strong>JPA Standard / Hibernate</strong>：选用J2EE标准的JPA规范作为数据存取层的实现，Hibernate作为优秀的JPA实现，在Macula平台中，默认使用Hibernate的JPA实现。</li><li><strong>Freemarker</strong>：Freemarker作为展示模版的优秀框架，可通过Macro宏、标签等多种方式代理JSP，除了Freemarker的性能与JSP不相上下外，Freemarker模板可根据多种方式载入，如类路径、Web路径、文件路径等，这样Freemarker模版可以方便的打包到业务插件JAR中。</li><li><strong>JSON</strong>：当前数据的传输标准，除XML外，JSON以其轻巧、易读以及传输量小的优点，在Macula平台中，在Ajax领域，使用JSON作为数据交换格式。</li><li><strong>jQuery/Bootstrap</strong>: 前端界面采用了标准的HTML5，使用jQuery和Bootstrap开发前端。</li></ul><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/overview-tech.jpg><img src=/docs/imgs/v3.1/chapter1/overview-tech.jpg alt=技术架构图></a></p><h2 id=功能规划>功能规划</h2><p>当前Macula平台包含Framework、Plugins、Mobile、UI、App SDK等部分。如下图：<br><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/overview-arch.png><img src=/docs/imgs/v3.1/chapter1/overview-arch.png alt=Macula平台功能规划图></a></p><h3 id=macula-framework>Macula Framework：</h3><ul><li><strong>macula-core</strong>：用来解决开发过程中，各层的开发基础以及部分基础代码，包括Repository基类、Domain基类、异常处理、校验、国际化等。</li><li><strong>macula-utils</strong>：助手模块，提供常用助手类，如excel导入导出、加解密、数字证书管理等功能。</li><li><strong>macula-base</strong>：包括三个子模块，分别是dataset、security和app，dataset用来提供数据源、数据集、参数和枚举等数据来源的定义；security用来解决用户身份的认证、用户角色授权、用户权限系统、菜单资源授权、用户在线信息、系统信息、强制用户登出、用户Session控制等。app将系统中所有的实例管理起来，为监控等进一步的应用做准备。</li></ul><h3 id=macula-plugins>Macula Plugins:</h3><p>除了上述介绍的部分模块外，Macula平台还引入插件的机制，通过在项目开发中提炼出一些有用的插件，加入了Macula平台中来，从而使得Macula平台更具有生命力:</p><ul><li><strong>macula-plugins-admin</strong>：用来管理用户权限、菜单资源管理、Action资源管理、资源注册、用户组注册等与界面相关的功能；</li><li><strong>macula-plugins-mda</strong>：模型驱动的快速开发插件，可以基于模型快速生成CRUD应用，解决大部分的重复工作；</li><li><strong>macula-plugins-webapp</strong>：该模块是WEB系统的入口点，处理主界面的显示，包括登录界面、菜单展现等，所有WEB系统的相关资源，如javascript库、FreeMarker的布局模板，全局的配置文件等也包含在这个模块中；</li><li><strong>macula-plugins-dubbo</strong>：如果需要基于Dubbo，则依赖该模块即可；</li><li><strong>macula-plugins-integration</strong>：集成模块，主要定位和其他系统的集成交互，比如log发送、事件送出等。</li></ul><h3 id=macula-mobile>Macula Mobile</h3><p>Macula Mobile模块主要提供App开发过程中后端的通用服务，比如推送、登录、版本管理、设备管理等功能。</p><h3 id=macula-ui>Macula UI</h3><p>基于jQuery和Bootstrap，我们开发了WEB应用的HTML5开发框架，该框架定义了CSS和Javascript组件，制定了Macula项目标准的前后端界面。</p><h3 id=通用服务能力>通用服务能力</h3><p>同时，基于Macula开发平台，也会引入相应的通用服务，比如统一认证、统一消息、统一规则引擎、统一流程引擎、统一调度平台等服务。</p></div><div class=td-content style=page-break-before:always><h1 id=pg-856bcd50b5341f8eb81a62e8fcb7a65e>2 - 快速开始</h1><div class=lead>本文介绍了基于Macula3.1的快速搭建项目过程</div><p>本章将通过macula-samples的创建过程介绍通过Macula平台开发业务系统的整个过程，对于其中的部分代码内容，将不做过多介绍。</p><h2 id=环境准备>环境准备</h2><p>“工欲善其事，必先利其器”，在开始介绍之前，我们需要准备相应的环境。</p><ul><li><p><strong>Java SDK</strong></p><p>Macula平台要求使用Java SDK的版本为1.6以上。</p></li><li><p><strong>Tomcat</strong></p><p>选择Tomcat6.0以上版本。</p></li><li><p><strong>Eclipse</strong></p><p>可选择最新的Eclipse 3.6.2版本，在Eclipse的多个发布版本中，选择Eclipse IDE for Java EE Developers，该版本包含了可部署的J2EE服务器适配。</p></li><li><p><strong>Maven-Eclipse插件</strong></p><p>Maven插件： <a href=http://download.eclipse.org/technology/m2e/releases>http://download.eclipse.org/technology/m2e/releases</a></p><p>Maven-Wtp插件：在安装了上面的插件后，在Preference->Maven ->Discovery中，选择WTP插件安装。</p></li><li><p><strong>svn-Eclipse插件</strong></p><p>SVN插件：<a href=http://subclipse.tigris.org/update_1.6.x/>http://subclipse.tigris.org/update_1.6.x/</a></p></li><li><p><strong>数据库（Oracle）</strong></p><p>准备运行时需要的数据库资源。</p></li></ul><p>另外，为了方便开发Freemarker模版等，可加入Freemarker IDE插件等，为了增强代码的健壮性，可加入FindBugs、CheckStyle等Eclipse插件。</p><h2 id=环境配置>环境配置</h2><h3 id=文件编码设置><strong>文件编码设置</strong></h3><p>Macula平台要求使用UTF-8的文件编码格式，可通过Eclipse -> Preference -> General -> Workspace 中，设定Text file encoding的方式设置项目环境为UTF-8编码。</p><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/tutorials-eclipse-workspace.jpg><img src=/docs/imgs/v3.1/chapter1/tutorials-eclipse-workspace.jpg alt=tutorials-eclipse-workspace.jpg></a></p><h3 id=服务器设置><strong>服务器设置</strong></h3><p>业务系统最终需要在J2EE容器中运行，这里选择Tomcat6.0作为服务器容器，在Eclipse中，需要进行相关配置。</p><p>通过Eclipse -> Preference -> Server -> Runtime Envionment选取增加Apache Tomcat6.0服务：</p><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/tutorials-eclipse-server.jpg><img src=/docs/imgs/v3.1/chapter1/tutorials-eclipse-server.jpg alt=tutorials-eclipse-server.jpg></a></p><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/tutorials-eclipse-tomcat.jpg><img src=/docs/imgs/v3.1/chapter1/tutorials-eclipse-tomcat.jpg alt=tutorials-eclipse-tomcat.jpg></a></p><h2 id=项目的创建>项目的创建</h2><p>Macula框架现在提供了一个创建我们所定义项目的maven插件，具体使用方式如下：</p><p>在eclipse中选择创建Maven Project</p><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/tutorials-new-project.png><img src=/docs/imgs/v3.1/chapter1/tutorials-new-project.png alt=tutorials-new-project.png></a></p><p>点击下一步后按照下面界面安装macula-tools-archetype插件（目前最新版本为1.0.7.RELEASE。如果已经存在无需再次安装）</p><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/tutorials-tools-archtype.png><img src=/docs/imgs/v3.1/chapter1/tutorials-tools-archtype.png alt=使用Macula插件创建项目></a></p><p>继续点击下一步如下图输入你项目的Group Id、Artifact Id、Version和Package:</p><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/tutorials-project-samples.png><img src=/docs/imgs/v3.1/chapter1/tutorials-project-samples.png alt=tutorials-project-samples.png></a></p><p>后面按照界面提示操作，即可生成整个项目的结构。然后在eclipse中右键选择Maven->Update Project。</p><h2 id=运行>运行</h2><p>运行上述项目需要按照以下步骤准备：</p><ul><li>安装mysql和redis</li><li>需要提供一个mysql数据库，创建好macula3和macula-samples，注意修改mysql数据库的相关连接信息</li><li>注意修改redis连接的相关信息</li><li>以上配置保存在applicationContext-root.xml中，可以根据需要修改</li><li>CustomMyUserLoginRepopsitory类需要关注，根据你的用户表获取用户信息构造凭据</li><li>如果你要改变登录、菜单等信息，可以关注CustomMyAppController类</li><li>删除macula-samples-parent/pom.xml, macula-samples-api/pom.xml文件中parent的部分</li><li>启动运行</li></ul><p>本程序中的演示程序URL是</p><p><a href=http://localhost:8080/macula-samples-webapp/admin/demo/application/list>http://localhost:8080/macula-samples-webapp/admin/demo/application/list</a></p><p>为了可以访问上述地址，你需要配置菜单、功能并做相应的授权</p><p>默认登录地址是</p><p><a href="http://localhost:8080/macula-samples-webapp/login?form=true">http://localhost:8080/macula-samples-webapp/login?form=true</a></p><p>默认登录用户是 admin,密码是infi123*</p><p>后端应用地址：<a href=http://localhost:8080/macula-samples-webapp/admin>http://localhost:8080/macula-samples-webapp/admin</a></p><p>前端应用地址：<a href=http://localhost:8080/macula-samples-webapp/front>http://localhost:8080/macula-samples-webapp/front</a></p><h2 id=打包>打包</h2><p>通过maven命令，mvn package可实现打包，如果需要发布到仓库中，可使用mvn install命令。</p><h2 id=程序开发>程序开发</h2><h3 id=概要介绍>概要介绍</h3><p>Macula 框架使用了 Spring，JPA（Hibernate），JQuery和KnockoutJS 等关键技术，所以要想熟练掌握框架，需要对这些技术很熟悉。一般做过 Java 开发的对 Spring 和 JPA（Hibernate） 都会有些了解，但对 JQuery 和 KnockoutJS 可能了解不多，特别是 KnockoutJS。所以有必要加强对 JQuery 和 KnockoutJS 的学习。 下面列举了 JQuery 和 KnockoutJS 的教程的链接，希望能帮助开发人员快速掌握这两种技术。</p><p>JQuery 教程</p><p><a href=http://docs.jquery.com/Tutorials>http://docs.jquery.com/Tutorials</a></p><p>KnockoutJS 教程</p><p><a href=http://learn.knockoutjs.com/>http://learn.knockoutjs.com/</a></p><p>下面我们以一个示例一步步详细解释整个开发过程。我们将要实现一个“应用管理”的功能，用于在我们的系统中保存应用的相关信息。我们需要提供新增、编辑、删除功能，以及一个列表功能来显示当前所有的应用信息。</p><h3 id=domain-和-repository-层>Domain 和 Repository 层</h3><p>首先，我们需要一个 Domain model 用于存放应用信息，然后还需要相对应的 Repository 来对应用信息进行增删改查等操作。Macula 平台的 Repository 层基于 Spring-Data-JPA（hibernate） 做了一些封装，功能很全面，只要在指定 package 下定义好 Domain model 和 Repository 接口，就可以实现很完善的数据存储功能。</p><h4 id=domain-定义>Domain 定义</h4><p>在业务系统中，Domain 可以接口与实现使用相同的类，简化开发的工作量，在实现类中通过 annotation 加上数据库表和字段的定义。 Domain 类放在 macula-xxx-repository 资源包里（如 macula-samples-repository），对应的 package 是类似这样：</p><pre tabindex=0><code>org.macula.samples.macula_samples.domain;
</code></pre><p>类的示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Entity</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@DynamicInsert</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@DynamicUpdate</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Table</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;DEMO_APPLICATION&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Auditable</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DemoApplication</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>AbstractAuditable</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Long</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>static</span> <span style=color:#204a87;font-weight:700>final</span> <span style=color:#204a87;font-weight:700>long</span> <span style=color:#000>serialVersionUID</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1L</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;APP_ID&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>nullable</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>unique</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@NotNull</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Length2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>appId</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;APP_NAME&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>nullable</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@NotNull</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Length2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;APP_GROUP&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>nullable</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@NotNull</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Length2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>appGroup</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;SECURE_KEY&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>nullable</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1024</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@NotNull</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Length2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1024</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>secureKey</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;PRIVATE_KEY&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>nullable</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1024</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@NotNull</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Length2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1024</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>privateKey</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;HOME_PAGE&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>nullable</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>255</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@NotNull</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Length2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>255</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>homepage</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;SUPERVISOR&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>255</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Length2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>255</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>supervisor</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;CONTACT&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>255</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Length2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>255</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>contact</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;COMMENTS&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>255</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Length2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>255</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>comments</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;THEME&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Length2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>min</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>max</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>theme</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;IS_SSIN&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>nullable</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>singleSignOn</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;IS_SSOUT&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>nullable</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>singleSignOut</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;USE_ATTRS&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>nullable</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#204a87;font-weight:700>boolean</span> <span style=color:#000>useAttributes</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Column</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;ALLOWED_ATTRS&#34;</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>String</span> <span style=color:#000>allowedAttributes</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//getters and setters
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>然后，通过在 EntityManagerFactory 的定义中加入 Domain 所在的包后，Macula 平台就可以自动扫描这些 Domain 定义，如下面示例代码①处所示。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>id=</span><span style=color:#4e9a06>&#34;entityManagerFactory_macula-samples&#34;</span> <span style=color:#c4a000>parent=</span><span style=color:#4e9a06>&#34;abstractEntityManagerFactory&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;persistenceUnitManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;bean</span> <span style=color:#c4a000>class=</span><span style=color:#4e9a06>&#34;org.springframework.orm.jpa.persistenceunit.DefaultPersistenceUnitManager&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;defaultPersistenceUnitName&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>&lt;value&gt;</span>macula-samples<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;defaultDataSource&#34;</span> <span style=color:#c4a000>ref=</span><span style=color:#4e9a06>&#34;macula-samples_dataSource&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;property</span> <span style=color:#c4a000>name=</span><span style=color:#4e9a06>&#34;packagesToScan&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>&lt;array&gt;</span>
</span></span><span style=display:flex><span>                       <span style=color:#8f5902;font-style:italic>&lt;!-- ① --&gt;</span>
</span></span><span style=display:flex><span>                     <span style=color:#204a87;font-weight:700>&lt;value&gt;</span>org.macula.samples.macula_samples.domain<span style=color:#204a87;font-weight:700>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>&lt;/array&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/bean&gt;</span>
</span></span></code></pre></div><h4 id=repository-定义>Repository 定义</h4><p>Repository 相当于 DAO 层，通过操作 Domain 存取数据。</p><p>Repository 一般只需要增加一个接口，并且继承 MaculaJpaRepository 就可以，Macula 平台可以在运行环境中自动产生实现类，并实现常用的 DAO 操作。</p><p>Repository 接口的示例如下：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>DemoApplicationRepository</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>MaculaJpaRepository</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DemoApplication</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Long</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>DemoApplication</span> <span style=color:#000>findByAppId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>appId</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DemoApplication</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>findByAppGroup</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>appGroup</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=列表功能>列表功能</h3><p>下面我们先来实现列表功能。</p><p>列表页面如下图所示：</p><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/list-page.png><img src=/docs/imgs/v3.1/chapter1/list-page.png alt=list-page.png></a></p><p>下面我们来说明这个功能的实现。</p><h4 id=展示层>展示层</h4><p>列表页面主要分为2个部分，第一部分是上面的功能按钮，第二部分是数据列表部分。</p><p>整个页面的结构是这样的：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#a40000>&lt;</span>@layout.mower_admin title=&#34;应用列表&#34; scripts=&#34;admin/macula-base/datasource/list_mower.js&#34;
</span></span><span style=display:flex><span>version=&#34;[$Revision: 4511 $]&#34; require=&#34;knockoutjs&#34;&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>#assign code=&#34;datasource-list&#34; /&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>@ui.panel&gt;
</span></span><span style=display:flex><span>        <span style=color:#a40000>&lt;</span>@ui.panel_head&gt;
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-xs-12 col-md-12&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                功能按钮部分
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#a40000>&lt;</span>/@ui.panel_head&gt;
</span></span><span style=display:flex><span>        <span style=color:#a40000>&lt;</span>@ui.panel_body&gt;
</span></span><span style=display:flex><span>                列表显示部分
</span></span><span style=display:flex><span>        <span style=color:#a40000>&lt;</span>/@ui.panel_body&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>/@ui.panel&gt;
</span></span><span style=display:flex><span><span style=color:#a40000>&lt;</span>/@layout.mower_admin&gt;
</span></span></code></pre></div><p>示例如下：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#a40000>&lt;</span>@layout.mower_admin title=&#34;应用列表&#34; scripts=&#34;admin/demo/application/list.js&#34; version=&#34;[$Revision: 4511 $]&#34; require=&#34;knockoutjs&#34;&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>#assign code=&#34;application-list&#34; /&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>@ui.panel&gt;
</span></span><span style=display:flex><span>        <span style=color:#a40000>&lt;</span>@ui.panel_head&gt;
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-xs-12 col-md-12&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;add-action-${code}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-default&#34;</span> <span style=color:#c4a000>data-toggle</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;pushBreadcrumb&#34;</span> <span style=color:#c4a000>data-label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;新增&#34;</span> <span style=color:#c4a000>data-page</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;admin/demo/application/create&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;fa fa-plus-circle fa-lg&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>i</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    新增
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;edit-action-${code}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-default&#34;</span> <span style=color:#c4a000>data-label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;编辑&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;fa fa-pencil fa-lg&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>i</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    编辑
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;delete-action-${code}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-danger&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;fa fa-trash-o fa-lg&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>i</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    删除
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#a40000>&lt;</span>/@ui.panel_head&gt;
</span></span><span style=display:flex><span>        <span style=color:#a40000>&lt;</span>@ui.panel_body&gt;
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;list-${code}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;table table-striped table-bordered table-hover&#34;</span> <span style=color:#c4a000>width</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;100%&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#c4a000>data-serverSide</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;true&#34;</span> 
</span></span><span style=display:flex><span>             <span style=color:#c4a000>data-paging</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;false&#34;</span> 
</span></span><span style=display:flex><span>             <span style=color:#c4a000>data-ordering</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;false&#34;</span> 
</span></span><span style=display:flex><span>             <span style=color:#c4a000>data-ajax-url</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${base}/admin/demo/application/apps&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#c4a000>data-ajax-type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;get&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#c4a000>data-select</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#c4a000>data-row-id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;id&#34;</span>
</span></span><span style=display:flex><span>             <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;datatables&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>thead</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;appGroup&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用分组<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;appId&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用编号<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用名称<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;supervisor&#34;</span><span style=color:#000;font-weight:700>&gt;</span>负责人<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;contact&#34;</span><span style=color:#000;font-weight:700>&gt;</span>联系方式<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;singleSignOn&#34;</span><span style=color:#000;font-weight:700>&gt;</span>支持单点登陆<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;singleSignOut&#34;</span><span style=color:#000;font-weight:700>&gt;</span>支持单点登出<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>thead</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#a40000>&lt;</span>/@ui.panel_body&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>/@ui.panel&gt;
</span></span><span style=display:flex><span><span style=color:#a40000>&lt;</span>/@layout.mower_admin&gt;
</span></span></code></pre></div><p>展示层用到了 JQuery 和 KnockoutJS 技术。下面从功能按钮部分开始，详细讲解一下相关内容。</p><p>功能按钮部分</p><p>先来看一下新增按钮在页面中的定义：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;add-action-${code}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-default&#34;</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>data-toggle</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;pushBreadcrumb&#34;</span> <span style=color:#c4a000>data-label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;新增&#34;</span>
</span></span><span style=display:flex><span><span style=color:#c4a000>data-page</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;admin/demo/application/create&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;fa fa-plus-circle fa-lg&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>i</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    新增
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>这个按钮用于显示“新增应用”的界面，里面没有太多处理，主要需要注意 <code>data-toggle 和 data-page的定义。data-toggle="pushBreadcrumb" 用于更新面包屑；data-page用于指定要显示的新页面的 url。</code></p><p>再来看一下编辑按钮，用户可以通过单击选中列表中的一条记录，然后点击编辑按钮来修改记录。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;edit-action-${code}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-default&#34;</span> <span style=color:#c4a000>data-label</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;编辑&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;fa fa-pencil fa-lg&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>i</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    编辑
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>这里我们直接用 JQuery 为这个按钮的 click 事件绑定了方法。在这个方法里，先获取被选中的记录的行 id，然后触发 pushBreadcrumb 事件，并转到编辑页面。对应绑定方法的定义在 .js 文件中，代码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 编辑按钮
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>_onEditAction</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;#edit-action-&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>code</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>click</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>e</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>ids</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>table</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>DataTable</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>selectedRowIds</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>ids</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>trigger</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>                <span style=color:#000>type</span> <span style=color:#ce5c00;font-weight:700>:</span><span style=color:#4e9a06>&#39;push.mu.breadcrumb&#39;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>                <span style=color:#000>page</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>base</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#39;/admin/demo/application/edit/&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>ids</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>           <span style=color:#000>MessageBox</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;请选择一条记录编辑.&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>};</span>
</span></span></code></pre></div><h4 id=数据列表部分>数据列表部分</h4><p>数据列表部分采用了 datatables 插件。我们只要定义表格结构和要显示的数据字段，以及做一些简单的配置就可以了。定义表格结构示例如下：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>table</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;list-${code}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;table table-striped table-bordered table-hover&#34;</span> <span style=color:#c4a000>width</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;100%&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>data-serverSide</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;true&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>data-paging</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;false&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>data-ordering</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;false&#34;</span> 
</span></span><span style=display:flex><span>    <span style=color:#c4a000>data-ajax-url</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${base}/admin/demo/application/apps&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>data-ajax-type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;get&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>data-select</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;true&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>data-row-id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;id&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;datatables&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>     <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>thead</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;appGroup&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用分组<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;appId&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用编号<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用名称<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;supervisor&#34;</span><span style=color:#000;font-weight:700>&gt;</span>负责人<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;contact&#34;</span><span style=color:#000;font-weight:700>&gt;</span>联系方式<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;singleSignOn&#34;</span><span style=color:#000;font-weight:700>&gt;</span>支持单点登陆<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>th</span> <span style=color:#c4a000>data-name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;singleSignOut&#34;</span><span style=color:#000;font-weight:700>&gt;</span>支持单点登出<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>th</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>tr</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>thead</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>table</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>其中，<code>data-serverSide指明数据是否从服务器端获取；data-paging指明数据是否分页显示；data-ordering指明是否对数据进行排序；data-ajax-url指明从服务器端获取数据的 URL；data-ajax-type指明向服务器端请求数据的方式，get 或 post；data-select指明数据表格中的行是否能被选中；data-row-id指明使用数据中的哪一列做为表格中的行的 id;rel="datatables"指明使用 datatables 插件。余下是表格表头的定义，表头中data-name的定义需要和服务器端返回的字段名一致。</code></p><p>对于 datatables 的具体使用方法请参考 Macula UI 官方文档的相关部分：<a href=http://macula.top/mower/view.html#datatables>Macula UI 官方文档 datatables 部分</a>。</p><h4 id=service-层>Service 层</h4><p>下面我们来看 Service 层的实现。Service 类放在 macula-xxx-service 资源包里（如 macula-samples-service）。Service 一般是先定义 Service 接口类，然后定义 Service 实现类。<br>注意要在 Service 实现类声明上面加上 annotation @Service。我们使用 @Autowired 完成 Repository 实例的自动注入，对于涉及到数据库修改的实现，需要加上 @Transactional。示例如下：</p><p>Service 接口示例:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>DemoApplicationService</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 获取所有的应用列表
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @return
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//①
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DemoApplication</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>getAllApplications</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 按应用名称获取指定的Application
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @param name
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @return
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#000>DemoApplication</span> <span style=color:#000>findApplicationByAppId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>appId</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 保存应用
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @param application
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @return
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Long</span> <span style=color:#000>saveApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 删除应用
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @param application
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>deleteApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>在列表功能中我们需要 Service 层提供一个方法用于获取所有的应用列表。我们先在 DemoApplicationService 接口中声明这个方法 #getAllApplications()，如代码中①处所示。</p><p>Service 实现类示例:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Service</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DemoApplicationServiceImpl</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>DemoApplicationService</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DemoApplicationRepository</span> <span style=color:#000>demoApplicationRepository</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//①
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DemoApplication</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>getAllApplications</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>List</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DemoApplication</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DemoApplication</span><span style=color:#ce5c00;font-weight:700>&gt;(</span><span style=color:#000>demoApplicationRepository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>findAll</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>result</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>DemoApplication</span> <span style=color:#000>findApplicationByAppId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>appId</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>demoApplicationRepository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>findByAppId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>appId</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Transactional</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Long</span> <span style=color:#000>saveApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updateApplicationInstances</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Long</span> <span style=color:#000>id</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>demoApplicationRepository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>save</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getId</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Transactional</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>deleteApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>demoApplicationRepository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>delete</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>我们在 DemoApplicationServiceImpl 实现类中提供了 #getAllApplications() 方法的实现，如代码中①处所示。</p><h4 id=controller-层>Controller 层</h4><p>Controller 要放在专门存放 Controller 类的 package 下，比如 org.macula.samples.macula_samples.admin.demo.controller。</p><p>先来看我们的示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span> <span style=color:#8f5902;font-style:italic>//①
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DempApplicationController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>DemoBaseController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//②
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DemoApplicationService</span> <span style=color:#000>demoApplicationService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/list&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>list</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getRelativePath</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/application/list&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//③
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/apps&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@OpenApi</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Page</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DemoApplication</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>getApplications</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>PageImpl</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DemoApplication</span><span style=color:#ce5c00;font-weight:700>&gt;(</span><span style=color:#000>demoApplicationService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getAllApplications</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/edit/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>edit</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@PathVariable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>Long</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>Model</span> <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>HttpServletRequest</span> <span style=color:#000>request</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>model</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>addAttribute</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getRelativePath</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/application/edit&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/create&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>create</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getRelativePath</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/application/edit&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/app/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@OpenApi</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>DemoApplication</span> <span style=color:#000>getApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@PathVariable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>application</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>application</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>DemoApplication</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>            <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSingleSignOn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setAppInstances</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DemoApplicationInstance</span><span style=color:#ce5c00;font-weight:700>&gt;());</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/save&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@OpenApi</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Long</span> <span style=color:#000>save</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@FormBean</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;application&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#5c35cc;font-weight:700>@Valid</span> <span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>hasErrors</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FormBindException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getMergedBindingResults</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>demoApplicationService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>saveApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/delete/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@OpenApi</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Long</span> <span style=color:#000>delete</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@PathVariable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>demoApplicationService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>deleteApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getId</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>关于上面的示例，有几点需要说明：</p><ol><li><p>Controller 类声明上面加上 annotation @Controller，如代码中①处所示，这个很重要，让我们的框架能自动识别这个类是 Controller 类。</p><p>自动扫描 Controller 的配置是在各资源包的这个文件中</p><p>src/main/resources/META-INF/spring/macula-xxx-servlet.xml</p><p>里面有一行用来设置需要扫描哪些 package。</p><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;context:component-scan</span> <span style=color:#c4a000>base-package=</span><span style=color:#4e9a06>&#34;org.macula.samples.macula_samples.admin.**.controller&#34;</span> <span style=color:#204a87;font-weight:700>/&gt;</span>
</span></span></code></pre></div></li><li><p>我们通过 annotation @Autowired 来实现 DemoApplicationService 的自动注入，如代码中②处所示。</p></li><li><p>我们使用 annotation @RequestMapping 来实现URL映射。在这个功能中，我们需要获得所有应用的信息，相对的 URL 为 /application/apps ，因此调用到的方法为 #getApplications()，如代码中③处所示。</p></li><li><p>你可能已经留意到在 #getApplications() 方法上有一个 @OpenApi 的注解。由于我们的列表页面中数据表格的内容是通过 AJAX JSON 方式获取的，因此我们使用 @OpenApi 直接返回 pojo bean。有关 @OpenApi 的详细介绍，请参阅核心技术中的相关介绍。</p></li></ol><p>至此，我们的列表功能就完成了。大致上就是在页面上使用了 datatables 插件通过 AJAX JSON 的方式向后台请求数据表格内容， Controller 接收到请求后调用 Serivce 中相应的方法， 而 Serivce 通过 Repository 从数据库中获取相关数据。</p><h3 id=新增及修改功能>新增及修改功能</h3><p>新增/修改页面如下：</p><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/edit-page.png><img src=/docs/imgs/v3.1/chapter1/edit-page.png alt=edit-page.png></a></p><p>新增和修改页面一般使用相同的 .ftl 和 .js 文件，通过逻辑判断当前处理的操作是新增还是修改。如果新增和修改功能差别很大，就需要考虑分开两个页面。在本例中，我们使用的是同一个页面。</p><h4 id=展示层-1>展示层</h4><p>新增/修改页面主要分为2个部分，第一部分是上面的功能按钮，第二部分是页面内容。</p><p>整个页面的结构是这样的：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#a40000>&lt;</span>#assign title&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>#if id?exists&gt;编辑应用<span style=color:#a40000>&lt;</span>#else&gt;新增应用<span style=color:#a40000>&lt;</span>/#if&gt;
</span></span><span style=display:flex><span><span style=color:#a40000>&lt;</span>/#assign&gt;
</span></span><span style=display:flex><span><span style=color:#a40000>&lt;</span>@layout.mower_admin title=title scripts=&#34;admin/demo/application/edit.js&#34; version=&#34;[$Revision: 4511 $]&#34; require=&#34;knockoutjs&#34;&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>#assign code=&#34;edit-application&#34; /&gt;
</span></span><span style=display:flex><span>        <span style=color:#a40000>&lt;</span>@ui.panel&gt;
</span></span><span style=display:flex><span>            <span style=color:#a40000>&lt;</span>@ui.panel_head&gt;
</span></span><span style=display:flex><span>                功能按钮
</span></span><span style=display:flex><span>            <span style=color:#a40000>&lt;</span>/@ui.panel_head&gt;
</span></span><span style=display:flex><span>            <span style=color:#a40000>&lt;</span>@ui.panel_body&gt;
</span></span><span style=display:flex><span>                页面内容
</span></span><span style=display:flex><span>            <span style=color:#a40000>&lt;</span>/@ui.panel_body&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>/@ui.panel&gt;
</span></span><span style=display:flex><span><span style=color:#a40000>&lt;</span>/@layout.mower_admin&gt;
</span></span></code></pre></div><p>这个文件是比较容易理解的。首先是定义页面的 title，通过判断数据的 id 是否存在来决定显示“编辑应用”还是“新增应用”，这里使用了 freemarker 的 exists 标签；然后是功能按钮；最后是页面内容，一般都是一个表单，对应着 label 和输入框，示例如下：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#a40000>&lt;</span>#assign title&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>#if id?exists&gt;编辑应用<span style=color:#a40000>&lt;</span>#else&gt;新增应用<span style=color:#a40000>&lt;</span>/#if&gt;
</span></span><span style=display:flex><span><span style=color:#a40000>&lt;</span>/#assign&gt;
</span></span><span style=display:flex><span><span style=color:#a40000>&lt;</span>@layout.mower_admin title=title scripts=&#34;admin/demo/application/edit.js&#34; version=&#34;[$Revision: 4511 $]&#34; require=&#34;knockoutjs&#34;&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>#assign code=&#34;edit-application&#34; /&gt;
</span></span><span style=display:flex><span>        <span style=color:#a40000>&lt;</span>@ui.panel&gt;
</span></span><span style=display:flex><span>            <span style=color:#a40000>&lt;</span>@ui.panel_head&gt;
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-xs-12 col-md-12&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;save-action-${code}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-primary&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;fa fa-check-circle fa-lg&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>i</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        保存
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;cancel-action-${code}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-default&#34;</span> <span style=color:#c4a000>data-toggle</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;popBreadcrumb&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;fa fa-reply fa-lg&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>i</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        取消
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#a40000>&lt;</span>/@ui.panel_head&gt;
</span></span><span style=display:flex><span>            <span style=color:#a40000>&lt;</span>@ui.panel_body&gt;
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-${code}&#34;</span> <span style=color:#c4a000>item-id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${id?if_exists}&#34;</span> <span style=color:#c4a000>action</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;${base}/admin/demo/application/save&#34;</span> <span style=color:#c4a000>method</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;post&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-horizontal&#34;</span> <span style=color:#c4a000>rel</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;validate-form&#34;</span> <span style=color:#c4a000>data-bv-container</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;tooltip&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;hidden&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.id&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: id&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-body&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>h3</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-section&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用信息<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>h3</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;row&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用编号：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#8f5902;font-style:italic>&lt;!-- ① --&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.appId&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: appId&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span> <span style=color:#c4a000>required</span> <span style=color:#c4a000>maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;50&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用名称：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.name&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: name&#34;</span>  <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span> <span style=color:#c4a000>required</span> <span style=color:#c4a000>maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;50&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;row&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用分组：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.appGroup&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: appGroup&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span> <span style=color:#c4a000>required</span> <span style=color:#c4a000>maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;50&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用风格：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.theme&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: theme&#34;</span>  <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span> <span style=color:#c4a000>required</span> <span style=color:#c4a000>maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;50&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;row&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用密钥：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;input-group input-group-sm&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>span</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;input-group-btn&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>button</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;gen-key-action&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-default&#34;</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;button&#34;</span><span style=color:#000;font-weight:700>&gt;</span>Go!<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>button</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>span</span><span style=color:#000;font-weight:700>&gt;</span>                                        
</span></span><span style=display:flex><span>                                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.secureKey&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: secureKey&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span> <span style=color:#c4a000>required</span> <span style=color:#c4a000>maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;1024&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>                        
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用私钥：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.privateKey&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: privateKey&#34;</span>  <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span> <span style=color:#c4a000>required</span>  <span style=color:#c4a000>maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;1024&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;row&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>应用入口：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.homepage&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: homepage&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span> <span style=color:#c4a000>required</span>  <span style=color:#c4a000>maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;1024&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>负责人：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.supervisor&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: supervisor&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span> <span style=color:#c4a000>required</span>  <span style=color:#c4a000>maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;255&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;row&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>联系方式：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.contact&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: contact&#34;</span>  <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span> <span style=color:#c4a000>required</span> <span style=color:#c4a000>maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;255&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox-inline&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;hidden&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.singleSignOn&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: singleSignOn, type: &#39;boolean&#39; &#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checked: singleSignOn&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                            支持单点登录
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox-inline&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;hidden&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.singleSignOut&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: singleSignOut, type: &#39;boolean&#39; &#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checked: singleSignOut&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                            支持单点登出
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox-inline&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;hidden&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.useAttributes&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: useAttributes, type: &#39;boolean&#39; &#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checked: useAttributes&#34;</span> <span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                            回传属性
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;row&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>属性列表：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.allowedAttributes&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: allowedAttributes&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span> <span style=color:#c4a000>maxlength</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;1024&#34;</span><span style=color:#000;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-6&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-group&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;control-label col-md-3&#34;</span><span style=color:#000;font-weight:700>&gt;</span>备注：<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;col-md-9&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>textarea</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span>  <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;application.comments&#34;</span> <span style=color:#c4a000>data-bind</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;value: comments&#34;</span> <span style=color:#c4a000>rows</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;2&#34;</span>  <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;form-control input-sm&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>textarea</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>form</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#a40000>&lt;</span>/@ui.panel_body&gt;
</span></span><span style=display:flex><span>    <span style=color:#a40000>&lt;</span>/@ui.panel&gt;
</span></span><span style=display:flex><span><span style=color:#a40000>&lt;</span>/@layout.mower_admin&gt;
</span></span></code></pre></div><p>里面要注意的是对于输入框的定义，有个数据绑定（data-bind）的处理， 如①处所示，我们在下面 edit.js 里会说明。</p><p>edit.js 主要是完成2项工作：</p><ol><li>通过 Ajax 读取服务器端的数据，构造跟 edit.ftl 页面对应的 model，实现数据和页面输入元素的绑定；</li><li>绑定 edit.ftl 页面里对应的按钮操作。</li></ol><p>代码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>ApplicationForm</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>$</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>code</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;edit-application&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>parentCode</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;application-list&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>$form</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;#form-&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>code</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>viewModel</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>self</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>this</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>ko</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>mapping</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>fromJS</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{},</span> <span style=color:#000>self</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>init</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic>// 初始化界面数据
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#8f5902;font-style:italic>//①
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>currentId</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>attr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;item-id&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>currentId</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#8f5902;font-style:italic>// -1 means server return add object struct
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>                <span style=color:#000>currentId</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>-</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic>//②
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getJSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>base</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#39;/admin/demo/application/app/&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>currentId</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#000>ko</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>applyBindings</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>viewModel</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>returnObject</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>$form</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>]);</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic>//③
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#8f5902;font-style:italic>// 绑定按钮事件
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;#save-action-&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>code</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>click</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>e</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>that</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>this</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>                <span style=color:#000>$form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ajaxValidSubmit</span><span style=color:#000;font-weight:700>({</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>success</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                        <span style=color:#000>MessageBox</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>success</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;保存成功&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>                        <span style=color:#000>that</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>trigger</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;pop.mu.breadcrumb&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>                        <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;#list-&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>parentCode</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>DataTable</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>ajax</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>reload</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>error</span> <span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>};</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}(</span><span style=color:#000>jQuery</span><span style=color:#000;font-weight:700>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>ApplicationForm</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>init</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>});</span>
</span></span></code></pre></div><p>关于以上代码，我们有几点要说明一下：</p><ol><li>在①处，我们先判断 item-id 在页面中是否存在。如果存在，我们认为是编辑页面，我们会根据这个item-id 通过 AJAX 方式从后台获取这个应用的相关信息；否则，我们认为这是个新增页面，令 item-id 等于-1, 从后台返回一个新的空白对象。</li><li>在②处，我们通过 knockoutJS 将用 AJAX 方式从后台获得的应用相关信息或新的空白对象绑定到页面的输入元素中。</li><li>在③处，我们为保存按钮绑定 click 事件，通过 AJAX 提交表单。保存成功后，返回列表页面并刷性列表页面中的数据表格。</li></ol><h4 id=service-层-1>Service 层</h4><p>Service 层的要点在列表功能中已经解析过，这里我们直接给出新增/修改功能的相关代码。</p><p>Service 接口示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>DemoApplicationService</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 按应用名称获取指定的Application
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @param name
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @return
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#000>DemoApplication</span> <span style=color:#000>findApplicationByAppId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>appId</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 保存应用
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @param application
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @return
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Long</span> <span style=color:#000>saveApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//... 其它部分省略
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>Service 实现类示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Service</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DemoApplicationServiceImpl</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>DemoApplicationService</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DemoApplicationRepository</span> <span style=color:#000>demoApplicationRepository</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>DemoApplication</span> <span style=color:#000>findApplicationByAppId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>String</span> <span style=color:#000>appId</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>demoApplicationRepository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>findByAppId</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>appId</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Transactional</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Long</span> <span style=color:#000>saveApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>updateApplicationInstances</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Long</span> <span style=color:#000>id</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>demoApplicationRepository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>save</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>).</span><span style=color:#c4a000>getId</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>id</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//... 其它部分省略
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=controller-层-1>Controller 层</h4><p>Controller 层相关代码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DempApplicationController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>DemoBaseController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DemoApplicationService</span> <span style=color:#000>demoApplicationService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//①
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/create&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>String</span> <span style=color:#000>create</span><span style=color:#ce5c00;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>super</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getRelativePath</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;/application/edit&#34;</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//②
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/app/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>GET</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@OpenApi</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>DemoApplication</span> <span style=color:#000>getApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@PathVariable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>application</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>application</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>DemoApplication</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>            <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setSingleSignOn</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>true</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>            <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>setAppInstances</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>ArrayList</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>DemoApplicationInstance</span><span style=color:#ce5c00;font-weight:700>&gt;());</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//③
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/save&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@OpenApi</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Long</span> <span style=color:#000>save</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@FormBean</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;application&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#5c35cc;font-weight:700>@Valid</span> <span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>hasErrors</span><span style=color:#ce5c00;font-weight:700>())</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>throw</span> <span style=color:#204a87;font-weight:700>new</span> <span style=color:#000>FormBindException</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>getMergedBindingResults</span><span style=color:#ce5c00;font-weight:700>());</span>
</span></span><span style=display:flex><span>        <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>demoApplicationService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>saveApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//... 其它部分省略
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>以上代码，我们有几点需要说明一下：</p><ol><li>在列表页面中，当点击新增按钮时，返回的也是 /application/edit 页面，如代码①处所示。</li><li>在②处我们返回应用的信息或一个新的空白对象。在这里我们通过 annotation @PathVariable 来实现了对主键到相应 Domain 实例的转换，有关这部分的内容可以参考核心技术中的相关部分。</li><li>③处用于保存应用信息。有关参数绑定和校验的内容请参考核心技术中的相关部分。</li></ol><p>至此，新增/修改功能已经完成。</p><h3 id=删除功能>删除功能</h3><p>删除功能一般是直接在列表页面里做的。用户选中某条记录，然后点击删除按钮，程序会调用服务器端相应的处理，然后根据返回值做结果提示。例如：</p><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/delete-page.png><img src=/docs/imgs/v3.1/chapter1/delete-page.png alt=delete-page.png></a></p><h4 id=展示层-2>展示层</h4><p>我们先看一下列表页面上对于删除功能按钮的定义。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>a</span> <span style=color:#c4a000>id</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;delete-action-${code}&#34;</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;btn btn-danger&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>i</span> <span style=color:#c4a000>class</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;fa fa-trash-o fa-lg&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>i</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    删除
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>a</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>上面的按钮点击后会触发 onDeleteAction 方法，这个方法是在 list.js 里定义的，代码如下:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// 删除按钮
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>_oDeleteAction</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;#delete-action-&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>code</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>click</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>e</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>row</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>table</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>DataTable</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>selectedRows</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>row</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#000>row</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>ModalBox</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>confirm</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;您确定要删除应用&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#39;【&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>row</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>].</span><span style=color:#000>appId</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#39;】吗？&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>result</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>result</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#000>$</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>post</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>base</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#4e9a06>&#39;/admin/demo/application/delete/&#39;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>row</span><span style=color:#000;font-weight:700>[</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>].</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>function</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>success</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                        <span style=color:#000>$</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>table</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>DataTable</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>ajax</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>reload</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                        <span style=color:#000>AlertBox</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>exceptionMessage</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>                    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>               <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>                <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>           <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span>       <span style=color:#000;font-weight:700>}</span> <span style=color:#204a87;font-weight:700>else</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>           <span style=color:#000>MessageBox</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>info</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;请选择一条记录删除.&#39;</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>       <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>});</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>};</span>
</span></span></code></pre></div><h4 id=service-层-2>Service 层</h4><p>Service 层的要点在列表功能中已经解析过，这里我们直接给出相关代码。</p><p>Service 接口示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>interface</span> <span style=color:#000>DemoApplicationService</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>/**
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 删除应用
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     * @param application
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>deleteApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//... 其它部分省略
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>Service 实现类示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Service</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DemoApplicationServiceImpl</span> <span style=color:#204a87;font-weight:700>implements</span> <span style=color:#000>DemoApplicationService</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DemoApplicationRepository</span> <span style=color:#000>demoApplicationRepository</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Transactional</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>deleteApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>demoApplicationRepository</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>delete</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//... 其它部分省略
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=contoller-层>Contoller 层</h4><p>Contoller 层相关代码如下：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#5c35cc;font-weight:700>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>public</span> <span style=color:#204a87;font-weight:700>class</span> <span style=color:#000>DempApplicationController</span> <span style=color:#204a87;font-weight:700>extends</span> <span style=color:#000>DemoBaseController</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@Autowired</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>private</span> <span style=color:#000>DemoApplicationService</span> <span style=color:#000>demoApplicationService</span><span style=color:#ce5c00;font-weight:700>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@RequestMapping</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>value</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/application/delete/{id}&#34;</span><span style=color:#ce5c00;font-weight:700>,</span> <span style=color:#000>method</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>RequestMethod</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>POST</span><span style=color:#ce5c00;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#5c35cc;font-weight:700>@OpenApi</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>public</span> <span style=color:#000>Long</span> <span style=color:#000>delete</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#5c35cc;font-weight:700>@PathVariable</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#000>DemoApplication</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>demoApplicationService</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>deleteApplication</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>);</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>application</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#c4a000>getId</span><span style=color:#ce5c00;font-weight:700>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>//... 其它部分省略
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>}</span>
</span></span></code></pre></div><p>至此，删除功能已经完成。</p><p>到这里，我们就完成了一个完整的增删改查功能。</p></div><div class=td-content style=page-break-before:always><h1 id=pg-68884f4139f98cc70f503022886b0dc0>3 - 项目构建</h1><div class=lead>本文介绍了项目构建过程</div><h2 id=maven及目录结构>Maven及目录结构</h2><p>通过macula-tools-archtype可以自动生成如下项目结构：</p><p><a data-fancybox=gallery href=/docs/imgs/v3.1/chapter1/tutorials-project-tree.png><img src=/docs/imgs/v3.1/chapter1/tutorials-project-tree.png alt=tutorials-project-tree.png></a></p><p>macula tools默认创建的项目结构是典型的三层架构，包含了如下模块：</p><ul><li><strong>macula-samples</strong>：项目最外层的模块，主要用于打包分发项目；</li><li><strong>macula-samples-parent</strong>：所有模块的父模块，提供了公共依赖项的配置和其它子模块依赖项的版本设置；</li><li><strong>macula-samples-repository</strong>：该模块包含domain和repository两个package，domain package存放与数据库表的映射类，repository存放数据库的存取操作类，domain是基于JPA和Hibernate的，repository主要采用spring-data；</li><li><strong>macula-samples-service</strong>：该模块主要包含业务逻辑层，通过调用repository来完成数据库的读写；</li><li><strong>macula-samples-admin/front/mobile</strong>：界面层模块，包含所有的Controller、Freemarker模块、Javascript文件，Controller主要基于Spring MVC，freemarker和javascript基于Macula UI(Mower)的规范编写页面；</li><li><strong>macula-samples-webapp</strong>：war包的打包模块，该模块包含了全局配置文件，javascript、css、image等静态资源文件，web.xml等J2EE WEB模块的标准文件，并负责将上述模块打包成一个war发布。</li></ul><p><strong>例 3.1. macula-samples-parent中唯一的文件pom.xml</strong></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#8f5902;font-style:italic>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;project</span> <span style=color:#c4a000>xmlns=</span><span style=color:#4e9a06>&#34;http://maven.apache.org/POM/4.0.0&#34;</span> <span style=color:#c4a000>xmlns:xsi=</span><span style=color:#4e9a06>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style=color:#c4a000>xsi:schemaLocation=</span><span style=color:#4e9a06>&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style=color:#204a87;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;modelVersion&gt;</span>4.0.0<span style=color:#204a87;font-weight:700>&lt;/modelVersion&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;groupId&gt;</span>org.macula.samples<span style=color:#204a87;font-weight:700>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;artifactId&gt;</span>macula-samples-parent<span style=color:#204a87;font-weight:700>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;version&gt;</span>0.0.1-SNAPSHOT<span style=color:#204a87;font-weight:700>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;packaging&gt;</span>pom<span style=color:#204a87;font-weight:700>&lt;/packaging&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;name&gt;</span>macula-samples-parent<span style=color:#204a87;font-weight:700>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;properties&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;project.build.sourceEncoding&gt;</span>UTF-8<span style=color:#204a87;font-weight:700>&lt;/project.build.sourceEncoding&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;jdkLevel&gt;</span>1.7<span style=color:#204a87;font-weight:700>&lt;/jdkLevel&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;jvmargs&gt;</span>-XX:MaxPermSize=384m -Xms512m -Xmx1024m<span style=color:#204a87;font-weight:700>&lt;/jvmargs&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;macula.version&gt;</span>3.0.0-SNAPSHOT<span style=color:#204a87;font-weight:700>&lt;/macula.version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;macula.plugins.version&gt;</span>3.0.0-SNAPSHOT<span style=color:#204a87;font-weight:700>&lt;/macula.plugins.version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;mockito.version&gt;</span>1.9.5<span style=color:#204a87;font-weight:700>&lt;/mockito.version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;junit.version&gt;</span>4.12<span style=color:#204a87;font-weight:700>&lt;/junit.version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;hsql.version&gt;</span>2.3.2<span style=color:#204a87;font-weight:700>&lt;/hsql.version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;spring.version&gt;</span>4.1.7.RELEASE<span style=color:#204a87;font-weight:700>&lt;/spring.version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;servlet.version&gt;</span>3.0.1<span style=color:#204a87;font-weight:700>&lt;/servlet.version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;jta.version&gt;</span>1.1<span style=color:#204a87;font-weight:700>&lt;/jta.version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;oracle.version&gt;</span>11.2.0.3.0<span style=color:#204a87;font-weight:700>&lt;/oracle.version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;mysql.version&gt;</span>5.1.35<span style=color:#204a87;font-weight:700>&lt;/mysql.version&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;liquibase.version&gt;</span>3.0.8<span style=color:#204a87;font-weight:700>&lt;/liquibase.version&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/properties&gt;</span>
</span></span><span style=display:flex><span>    .....
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/project&gt;</span>
</span></span></code></pre></div><p>在macula-samples-parent的maven设置中，指定了maven第三方包获取点：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;repositories&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;repository&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;id&gt;</span>macula-repo<span style=color:#204a87;font-weight:700>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;name&gt;</span>macula-repo<span style=color:#204a87;font-weight:700>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>&lt;url&gt;</span>http://maven.infinitus.com.cn:8081/nexus/content/groups/public<span style=color:#204a87;font-weight:700>&lt;/url&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>&lt;/repository&gt;</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>&lt;/repositories&gt;</span>
</span></span></code></pre></div><p>当前所有macula平台所需要使用的第三方包均可以在上述获取点获得，为了规范第三方包的使用以及避免版本冲突，在进行依赖macula平台开发的业务系统中，只允许依赖macula平台的模块，对于需要依赖第三方包的，需要提交审批，审批通过后，将在上述maven获取点能获取到该第三方报，业务系统方能使用，否则不允许使用。</p><p>下面以macula-samples下的包为例，介绍其目录及文件的含义。</p><ol><li><p>jar模块目录结构</p><p>在maven创建项目后，将创建目录：</p><ul><li><p>src/main/java ：该目录放置java的主要开发代码，即最终运行需要的java类，这个目录的内容最终将打包到jar中。</p></li><li><p>src/main/resources ：该目录放置除java带的其他资源文件，如xml、properties文件等，这个目录的内容最终也将被打包到jar中。</p></li><li><p>src/test/java ：该目录主要存放JUnit测试的java代码，用于测试阶段的代码，这个目录的内容将不打包到jar中。</p></li><li><p>src/test/resources ：该目录存放测试下需要使用的资源文件，如xml、properties文件等，这个目录的内容也不会打包到jar文件中。</p><p><strong>重要</strong></p><p><em>需要特别强调的是，测试文件必须放在test目录下，以降低打包jar文件的大小以及代码结构的清晰度，对于编写的JUnit用例，必须放在测试目录。另外对于src/main/resources中存放文件的目录结构（包括Spring配置文件的放置、Freemarker模块文档的放置等），将在其他相应章节中介绍，这里主要介绍大方向的目录结构。</em></p></li></ul></li><li><p>war模块目录结构</p><p>war模块可通过maven-wtp插件，将war模块直接发布到Eclipse定义的Server中，对于war模块，除了具备jar模块的文档结构外，另外增加了src/main/webapp目录，该目录按标准的J2EE应用的目录格式和命名方式。特别的，对于src/main/webapp下的目录结构，也需要严格按照下列命名：</p><ul><li>webapp/META-INF ：下面放置该模块的一些自描述信息。</li><li>webapp/resources ：该目录下放置静态内容信息，包括图片文件、javascript文件等。</li><li>webapp/WEB-INF ：该目录为标准的J2EE要求目录。</li></ul></li></ol><h2 id=文件命名>文件命名</h2><p>为了规范项目的开发，在文件命名方面有一定的规则：</p><ol><li><p>Java包（文件夹）的命名<br>Java包（文件夹）必须以小写字母命名，同时按照模块名称建立父包，并按照用途可创建controller、domain、repository、service、util、support、vo子包，避免创建晦涩难懂的包名，加大系统的复杂度。</p><ul><li><p>在macula-samples-repository模块中，包名不包含业务模块名称：</p><ul><li>domain：org.macula.samples.domain</li><li>repository：org.macula.samples.repository</li></ul></li><li><p>在macula-samples-service和admin/front/mobile模块中，包名最好包含业务模块的名称：</p><ul><li>service：org.macula.samples.service.demo1.service</li><li>controller：org.macula.samples.admin.demo1.controller</li></ul></li></ul></li><li><p>国际化文件
国际化的properties文件，统一放置在resources/i18n目录下，并按模块名称建立子目录，如macula-samples-admin的国际化文件必须放置在resources/i18n/macula-samples-admin目录下，这样可避免文件的重名。</p></li><li><p>Spring配置文件<br>对Spring的配置文件，必须放置在resources/META-INF/spring目录下，并在命名上按下列要求命名：</p><ul><li>应用层的命名：按照macula-模块名称-app.xml的方式命名。</li><li>WEB层的命名：按照macula-模块名称-servlet.xml的方式命名。</li></ul></li><li><p>Freemarker文件<br>Freemarker文件放置在resources/views目录下，并按模块名称创建子目录。</p><p>如resources/views/admin/demo1/xxx/edit.ftl</p></li></ol><h2 id=自定义目录>自定义目录</h2><p>在应用开发中，需要自定义目录的情况较少，如无特殊需要，尽量减少自定义目录的情况，自定义目录会增加项目组沟通成本以及维护成本。</p><p>对于自定义目录的情况大致有：</p><ul><li><p>为多种环境创建不同的配置<br>这种情况下，主要使用src/resources/configs/xxx目录创建同名文件，并通过启动时加入-Dmacula.profile=xxx来切换配置文件。</p></li><li><p>webapp目录下增加其他静态文件<br>对war模块，对于webapp下需要载入的大量的静态文件以及脚本文件，可能会加入自定义目录。</p></li></ul><h2 id=配置文件>配置文件</h2><p>macula平台下涉及的文件包括：</p><ul><li>macula.properties：开发平台配置文件</li><li>Spring配置文件，将在配置文件章节介绍</li><li>log4j.properties：log4j的配置文件</li><li>freemarker.properties：freemarker模版的配置文件</li></ul><h2 id=依赖包及版本>依赖包及版本</h2><p>Macula开发平台自身依赖了大量的第三方包，在业务系统开发中，使用依赖macula平台的模块即可，对于具体的依赖包及版本，可查看macula-parent模块中定义的pom.xml文件。</p></div><div class=td-content style=page-break-before:always><h1 id=pg-fee5264e2587493d9d70bfda97be4f07>4 - 版本发布</h1><div class=lead>本文介绍了版本发布记录</div><h2 id=v300>v3.0.0</h2><ul><li><h3 id=spring-4>Spring 4</h3><p>Macula 3 将底层依赖的Spring 升级到Spring 4，以提供对Spring 新特性的支持。Spring 4 支持Java 8， 在核心容器、Web、WebSocket编程、测试等方面都有所提高。</p></li><li><h3 id=全新的用户界面>全新的用户界面</h3><p>Macula 3 基于jQuery和Bootstrap构建了一套UI开发框架Mower，并且制定了后端与 前端的标准布局模板，减轻了开发人员构建用户界面的成本，有利于用户体验的提升。</p></li><li><h3 id=基于redis的会话管理>基于Redis的会话管理</h3><p>由于现在的应用系统大多有多个实例，传统的J2EE应用大多基于本JVM管理HTTP会话，但是多个实例之间 会话的同步与管理非常麻烦，Macula 3 基于Redis共享会话，大大简化了集群间用户会话的管理工作。</p></li><li><h3 id=微服务框架>微服务框架</h3><p>Macula 3 引入开源分布式服务框架Dubbo作为基础，以插件化形式提供对微服务架构的支持，简单易用。</p></li><li><h3 id=cat插件>CAT插件</h3><p>CAT 是一套基于Java的开源实时应用监控平台，主要应用于服务中间件框架的监控，为开发和运维提供各项性能指标、健康检查、自动报警等可视化服务。Macula提供CAT插件以减少开发人员的埋点工作量。</p></li></ul></div></main></div></div><script src=/js/jquery.fancybox.min.js></script>
<script src=/js/jquery.min.js></script>
<link rel=stylesheet href=/css/jquery.fancybox.min.css><div class=polaris-footer><span>@ 2022 The PolarisMesh Authors</span>
<span class=high-resolution>|</span>
<span>A Tencent Microservice Project</span>
<a href=https://beian.miit.gov.cn/#/Integrated/index>粤B2-20090059</a><div class=polaris-footer-background></div></div></div><script src=/js/main.min.be25a680a0d95dc8b5d6664622e2134aa894220e2f224ef609e00f633a3a1b32.js integrity="sha256-viWmgKDZXci11mZGIuITSqiUIg4vIk72CeAPYzo6GzI=" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script></body></html>